<section>
  <div class=>
    <p><a class="btn btn-info pull-right" ng-click="isPostFormOpen = !isPostFormOpen">New Post</a></p>
    <new-post ng-show="isPostFormOpen"></new-post>
  </div>

  <ul class="nav nav-pills">
    <li role="presentation" class="active">
      <input type="search" ng-model="searchText" id="searchText" class="form-control input-sm search-form" placeholder="Filter" autofocus="">
    </li>
    <br>
        <select class="form-control" ng-model="sortBy" name="sortBy">
          <option value="" disabled="">Sort By</option>
          <option value="count">Votes</option>
          <option value="dateCreated">Date</option>
          <option value="title">Title</option>
        </select>
    </li>
  </ul>
  <br>
<div class="row" ng-repeat="post in $ctrl.posts | orderBy: sortBy:true | filter:searchText" >
  <div class="col-md-12">

    <div class="well">
      <div class="media-left">
        <img ng-src="{{post.image_url}}" class="media-object">
        <a ui-sref='editPost({id:{{post.id}}})'>Edit Post</a>
      </div>
      <div class="media-body">
        <h4 class="media-heading">
          {{post.title}}
          |
          <a ng-click="$ctrl.addVote(post.id)"><i class="glyphicon glyphicon-arrow-up"></i></a>
          <a ng-click=$ctrl.deleteVote(post.id) ng-if="post.vote_count > 0"><i class="glyphicon glyphicon-arrow-down"></i></a>
          {{post.vote_count}}
        </h4>
        <div class="text-right">
          {{post.author}}
        </div>
        <p>
          {{post.body}}
        </p>
        <div>
          {{post.created_at | amDurationFormat : 'minute' }}
          |
          <i class="glyphicon glyphicon-comment"></i>
          <a ng-click="openComments = !openComments">
            {{post.comments.length}}
          </a>
        </div>
        <div class="row" ng-show="openComments" >
          <div class="col-md-offset-1">
            <hr>
            <div ng-repeat="comment in post.comments">
              <p >
                {{comment.content}}
                </p>
              <span>
                Posted:{{comment.created_at | amDurationFormat : 'minute' }}
              </span>
            </div>

            <form class="form-inline" ng-submit="$ctrl.addComment(post)">
              <div class="form-group">
                <input type="text" class="form-control" name="body" ng-model="post.newComment.content">
              </div>
              <div class="form-group">
                <input type="submit" class="btn btn-primary">
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
</section>
